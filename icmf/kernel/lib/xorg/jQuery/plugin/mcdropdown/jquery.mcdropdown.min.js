!function(e){e.fn.mcDropdown=function(t,i){var n;return this.each(function(){return(n=e.data(this,"mcDropdown"))?!1:void new e.mcDropDownMenu(this,t,i)}),n||this},e.mcDropdown={version:"1.3.9",setDefaults:function(i){e.extend(t,i)}};var t={minRows:8,maxRows:25,targetColumnSize:2,openFx:"slideDown",openSpeed:250,closeFx:"slideUp",closeSpeed:250,hoverOverDelay:200,hoverOutDelay:0,showFx:"show",showSpeed:0,hideFx:"hide",hideSpeed:0,dropShadow:!0,autoHeight:!0,lineHeight:19,screenPadding:10,allowParentSelect:!1,delim:":",showACOnEmptyFocus:!1,valueAttr:"rel",mouseintent:!1,click:null,select:null,init:null},i={};i.isIE=e.browser.msie||/\sTrident\/\d/i.test(window.navigator.userAgent),i.isIE6=i.isIE&&e.browser.version&&e.browser.version<=6,e.mcDropDownMenu=function(n,o,r){function s(t){var i,n=t.contents().filter(function(){return 1==this.nodeType||3==this.nodeType&&e.trim(this.nodeValue).length>0});return i=n[0]&&3==n[0].nodeType?n[0].nodeValue:n[0]&&1==n[0].nodeType?e(n[0]).text():"",e.trim(i)}function a(t){if(0==t.length)return[];var i=[s(t)];return t.parents().each(function(){var t=e(this);return this===W[0]?!1:void(t.is("li")&&i.push(s(t)))}),i.reverse()}function l(e){return a(S(e))}function d(e){return l(e).join(q.delim)}function h(t){c(t),e("> li",t).bind("mouseover.mcdropdown",p).bind("mouseout.mcdropdown",m)}function c(t){e("> li",t).unbind(".mcdropdown")}function u(t){var i=b(t,!0),n=C();i.bottom>n.y&&e("html,body").animate({scrollTop:"+="+(i.bottom-n.y+q.screenPadding)+"px"})}function p(){var t=this,i=g(t),n=e.data(t,"mcDropdown-timer");clearTimeout(n),e(this).addClass("mc_hover"),i.length&&e.data(t,"mcDropdown-timer",setTimeout(function(){v.apply(t),q.mouseintent&&i.bind("mouseenter.mcdropdown",function(){e(this).mouseintent(e.extend({},q.mouseintent,{mouseaway:function(){e.isFunction(q.mouseintent.mouseaway)&&q.mouseintent.mouseaway.apply(this,arguments),w.apply(t,[!0])}}))})},q.hoverOverDelay))}function m(t){var n=this,o=(e(n),g(n)),r=e.data(n,"mcDropdown-timer");clearTimeout(r),e(this).removeClass("mc_hover"),!o.length||q.mouseintent!==!1&&o.data("mouseintent")||e.data(n,"mcDropdown-timer",setTimeout(function(){w.apply(n,[!0])},q.hoverOutDelay)),i.isIE6&&t.stopPropagation()}function f(t){var i=O.data("mcDropdown-shadows");return i||(i={}),i[t]||(i[t]=e('<div class="mcdropdown_shadow"></div>').appendTo("body"),e.fn.bgIframe&&i[t].bgIframe(),O.data("mcDropdown-shadows",i)),i[t]}function g(t){return e("> ul",t)}function v(){var t=this,i=g(this);if(i.is(":visible")||0==i.length)return!1;e(this).parent().find("> li ul:visible").not(i).parent().each(function(){w.apply(this,[!0])}),x(i),h(i);var n=i.parents("ul").length,o=C(),r=b(e(this));i.css({top:r.bottom,right:r.marginRight}).show();var s=i.outerHeight()+i.offset().top;s>o.y&&i.css("top",r.bottom-(s-o.y)-q.screenPadding);var a=function(){if(q.dropShadow){var o=f(n),r=b(i);o.css({top:r.top+r.marginTop,right:r.right+r.marginRight,width:r.width,height:r.height,visibility:"visible"}).insertAfter(i).show(),e.data(t,"mcDropdown-shadow",o)}};q.showSpeed<=0?a():i.hide()[q.showFx](q.showSpeed,a)}function w(t){var n=g(this);if((n.is(":hidden")||0==n.length)&&t!==!0)return!1;var o=e.data(this,"mcDropdown-shadow");q.dropShadow&&o&&o.css({display:"",visibility:"hidden"}),i.isIE6&&n.css("visibility","hidden").parent().removeClass("mc_hover"),t===!0?n.stop().css({display:"",visibility:"hidden"}):n.stop()[q.hideFx](q.hideSpeed)}function b(t,i){var n=!1;t.is(":hidden")&&(n=!!t.css("visibility","hidden").show());var o=e.extend(t[i===!0?"offset":"position"](),{width:t.outerWidth(),height:t.outerHeight(),marginRight:parseInt(e.css(t[0],"marginRight",!0),10)||0,marginRight:parseInt(e.css(t[0],"marginRight",!0),10)||0,marginTop:parseInt(e.css(t[0],"marginTop",!0),10)||0,marginBottom:parseInt(e.css(t[0],"marginBottom",!0),10)||0});return o.marginTop<0&&(o.top+=o.marginTop),o.marginRight<0&&(o.right+=o.marginRight),o.bottom=o.top+o.height,o.right=o.right+o.width,n&&t.hide().css("visibility","visible"),o}function y(e,t,i){var n=b(e,i);return t.css({position:"absolute",top:n.bottom,right:n.right}),n.bottom}function C(){var t={scrollLeft:e(window).scrollLeft(),scrollTop:e(window).scrollTop(),width:e(window).width(),height:e(window).height()};return t.x=t.scrollLeft+t.width,t.y=t.scrollTop+t.height,t}function T(t,i){var n="height"==i?"Top":"Right",o="height"==i?"Bottom":"Left";return parseInt("0"+e.css(t,"border"+n+"Width",!0),10)+parseInt("0"+e.css(t,"border"+o+"Width",!0),10)+parseInt("0"+e.css(t,"padding"+n,!0),10)+parseInt("0"+e.css(t,"padding"+o,!0),10)+parseInt("0"+e.css(t,"margin"+n,!0),10)+parseInt("0"+e.css(t,"margin"+o,!0),10)}function _(e,t){if(!e.data("dimensions")){var i=j.outerWidth(),n=e===W&&e.data("width")*t<i?Math.floor(i/t):e.data("width");e.data("dimensions",{column:n,item:n-T(e.children().eq(0)[0],"width"),height:e.height()})}return e.data("dimensions")}function I(e){return q.autoHeight===!1?q.lineHeight:(e.data("height")||e.data("height",e.outerHeight()),e.data("height"))}function x(t){{var i=t.find("> li"),n=i.length,o=Math.ceil(n/q.maxRows),r=arguments[1]?arguments[1]:n<=q.minRows?1:o>q.targetColumnSize?o:q.targetColumnSize,s=_(t,r),a=0,l=0,d=0;Math.ceil(n/r),t.parent("li").width()}return t.css({visibility:"hidden",display:"block"}),i.each(function(t){var i,o=t+1,h=Math.floor(o/n*r),c=Math.floor(t/n*r),u=e(this);a!=c?(i=-1*(l+1),l=0):i=0,l+=I(u)||q.lineHeight,u.css({marginRight:s.column*c,marginTop:i,width:s.item})[h>c||o==n?"addClass":"removeClass"]("mc_endcol")[0!=i?"addClass":"removeClass"]("mc_firstrow"),l>d&&(d=l),a=c}),t!==W&&d+2*q.screenPadding>=C().height?x(t,r+1):(t.css("visibility","visible").height(d),t)}function S(e){return W.find("li["+q.valueAttr+"='"+e+"']")}function D(){return S(Z.val())}function k(){var t=D(),n=O.val().toLowerCase(),o=n.toLowerCase().split(q.delim),r=o.pop(),s=n.lastIndexOf(q.delim)+1;K=o.join(q.delim)+(o.length>0?q.delim:""),setTimeout(function(){P(O[0],s,s+r.length)},0),Q||(Q=e('<ul class="mcdropdown_autocomplete"></ul>').appendTo("body"),i.isIE6&&e.fn.bgIframe&&(U=e("<div></div>").bgIframe().appendTo("body")));var a=!(q.showACOnEmptyFocus&&0==K.length),l=0==t.length||t.hasClass("mc_root")?W.find("> li"):t.parent().find("> li");R(l,a)}function H(){it&&clearTimeout(it),it=setTimeout(function(){var e=D();if(!q.allowParentSelect&&e.is(".mc_parent")){var t=e.find("li:not('.mc_parent'):first").attr(q.valueAttr);J.setValue(t,!0)}var i=J.getValue(),t=i[0],n=i[1];Z.triggerHandler("update",[t,n,this]),O.triggerHandler("update",[t,n,this]),null!=q.select&&q.select.apply(J,[t,n]),E(),it=null},200)}function R(t,n){var o=t===$,r=o?Q.find("> li").removeClass("mc_hover mc_hover_parent mc_firstrow"):t.clone().removeAttr("style").removeClass("mc_hover mc_hover_parent mc_firstrow mc_endcol").filter(":last").addClass("mc_endcol").end();if(!o||Q.is(":hidden")){if(Q.empty().append(r).width(j.outerWidth()-T(Q[0],"width")).css("height","auto"),y(j.parent(),Q,!0),r.hover(function(){Q.find("> li").removeClass("mc_hover_parent mc_hover"),e(this).addClass("mc_hover")},function(){e(this).removeClass("mc_hover")}),r.find("> ul").css("display","none"),Q.show().css("visibility",n===!0?"hidden":"visible"),i.isIE6){var s=parseInt(Q.css("max-height"),10)||0;s>0&&s<Q.outerHeight()&&Q.height(s),e.fn.bgIframe&&y(j.parent(),U.css({height:Q.outerHeight(),width:Q.width()},!0).show())}n!==!0&&u(Q)}n===!0&&(Q.css({top:"-10000px",right:"-10000px"}),i.isIE6&&e.fn.bgIframe&&U.css("display","none"));var a=Q.find("li["+q.valueAttr+"='"+Z.val()+"']");a.addClass("mc_hover"+(a.is(".mc_parent")?"_parent":"")),a.length>0&&1!=n&&B(a),$=z=t}function E(){i.isIE6&&e.fn.bgIframe&&U&&U.hide(),Q&&Q.hide()}function A(e){var t=String.fromCharCode(e.keyCode||e.charCode).toLowerCase(),n=D(),o=0==n.length||n.hasClass("mc_root")?W.find("> li"):n.parent().find("> li"),r=K.split(q.delim),s=r.pop(),a=s+t,l=F(O[0]).toLowerCase(),d=O.val().toLowerCase();if(38==e.keyCode)return M(-1),!1;if(40==e.keyCode)return M(1),!1;if(27==e.keyCode)return K="",J.setValue(""),R(W.find("> li")),!1;if(8==e.keyCode||37==e.keyCode){if(a=37==e.keyCode?"":s.substring(0,s.length-1),l==s&&(s=""),r.length>0&&0==s.length)return V(n.parent().parent()),!1;if(l==d)return K="",J.setValue(""),!1}else{if(9==e.keyCode||13==e.keyCode||39==e.keyCode||t==q.delim){var h=n.find("> ul > li:first");if(h.length>0)V(h);else{if(i.isIE&&P(O[0],0,0),9==e.keyCode)return O.triggerHandler("blur"),E(),!0;O.trigger("blur"),E()}return!1}l==d&&(K="",a=t)}return z=L(o,a),z.length>0?(K=r.join(q.delim)+(r.length>0?q.delim:"")+a,V(z.eq(0),!0)):(a=a.length?a.substring(0,a.length-1):"",z=L(o,a),z.length>0?R(z):E()),e.preventDefault(),!1}function M(e){var t,i=D(),n=0;return 0==i.length&&(i=z.filter(".mc_hover, .mc_hover_parent")),(0==i.length||Q.is(":hidden"))&&(i=z.eq(0),e=0),z.each(function(e){return this===i[0]?(n=e,!1):void 0}),z&&0!=z.length&&0!=i.length?(n+=e,0>n?n=z.length-1:n>=z.length&&(n=0),t=z.eq(n),void V(t,!0)):!1}function L(t,i){var n=e([]);return t.each(function(){var t=e(this),o=s(t);o.substring(0,i.length).toLowerCase()==i&&(n=n.add(t))}),n}function V(e,t){var i=t?z:0==e.length||e.hasClass("mc_root")?W.find("> li"):e.parent().find("> li"),n=a(e),o=n.pop().toLowerCase();t||(K=n.join(q.delim).toLowerCase()+(n.length>0?q.delim:"")),J.setValue(e.attr(q.valueAttr),!0),P(O[0],K.length,o.length+K.length),i.filter(".mc_hover,.mc_hover_parent").removeClass("mc_hover mc_hover_parent"),e.addClass("mc_hover"+(e.is(".mc_parent")?"_parent":"")),R(i)}function F(e){var t="";if(e.setSelectionRange)t=e.value.substring(e.selectionStart,e.selectionEnd);else if(document.selection){var i=document.selection.createRange();i.parentElement()==e&&(t=i.text)}return t}function P(e,t,i){if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveStart("character",t),n.moveEnd("character",i),n.select()}else e.setSelectionRange?e.setSelectionRange(t,i):e.selectionStart&&(e.selectionStart=t,e.selectionEnd=i);e.focus()}function B(e,t){var i=e[0],n=Q[0],o={pTop:parseInt(Q.css("paddingTop"),10)||0,pBottom:parseInt(Q.css("paddingBottom"),10)||0,bTop:parseInt(Q.css("borderTopWidth"),10)||0,bBottom:parseInt(Q.css("borderBottomWidth"),10)||0};i.offsetTop+i.offsetHeight>n.scrollTop+n.clientHeight?n.scrollTop=e.offset().top+(n.scrollTop-Q.offset().top)-(n.clientHeight/(1==t?2:1)-(e.outerHeight()+o.pBottom)):i.offsetTop-o.bTop-o.bBottom<=n.scrollTop+o.pTop+o.pBottom&&(n.scrollTop=e.offset().top+(n.scrollTop-Q.offset().top)-o.pTop)}var O,W,j,q,z,$,Q,U,G,J=this,K="",N=!1;if(O=e(n),G=O.is(":input"),this.settings=q=e.extend({},t,r),q.mouseintent===!1||e.fn.mouseintent){if(q.mouseintent){var X={monitorMovement:!0,mouseAwayAfter:1500,borderThreshold:[0,150,150,0]};q.mouseintent=e.extend({},X,e.isPlainObject(q.mouseintent)?q.mouseintent:{})}}else q.mouseintent=!1;null==q.click&&(q.click=function(t,i,n){i.setValue(this.attr(n.valueAttr)?this.attr(n.valueAttr):e(this.parents("li")[0]).attr(n.valueAttr))}),e(document).bind("click",function(t){var i=e(t.target),n=i.parents().filter(function(){return this===W[0]||!!Q&&Q[0]===this});if(n.length){if(!i.is("li"))return!1;var o=i.is(".mc_parent");if(o&&Q&&n[0]===Q[0])return V(i.find("> ul > li:first"),!1),t.stopPropagation(),!1;if(!q.allowParentSelect&&o)return!1;if(i.not(".mc_root")&&w.apply(i.parent().parent()[0],[t]),null!=q.click&&0==q.click.apply(i,[t,J,q]))return!1}J.closeMenu()}),W="object"==typeof o&&o.jquery?o:e(o),W.appendTo("body").css({position:"absolute",top:-1e4,right:-1e4}).find("ul").andSelf().css("display","block").each(function(){var t=e(this);t.data("width",t[0].clientWidth)}).css({top:0,right:104,display:"none"}),W.find("> li").addClass("mc_root"),e("li > ul",W).parent().addClass("mc_parent"),j=e('<div class="mcdropdown"><a href="#" tabindex="-1"></a><input type="hidden" name="'+(n.name||n.id)+'" id="'+(n.id||n.name)+'" /></div>').appendTo(e('<div style="position: relative;"></div>')).parent();var Y=O.replaceWith(j).attr({id:"",name:""}),Z=j.find(":input");j=j.find(".mcdropdown").prepend(Y);var et=j.clone().css({position:"absolute",top:-9999999,right:-999999,visibility:"visible"}).show().appendTo("body"),tt={width:"95%",height:et.outerHeight()};et.remove(),e.data(Z[0],"mcDropdown",J),j.parent().height(tt.height),e.browser.safari&&setTimeout(function(){O.width(j.width()-e("a",j).width())},100),O.width(tt.width).filter(":input").attr("autocomplete","off").bind("keypress",A).bind("mousedown",function(t){return e(this).triggerHandler("focus"),t.stopPropagation(),!1}).bind("contextmenu",function(){return!1}).bind("focus",k).bind("blur",H),(i.isIE||e.browser.safari)&&O.bind("keydown",function(e){return",8,9,37,38,39,40,".indexOf(","+e.keyCode+",")>-1?A(e):void 0}),e("a",j).bind("click",function(e){return N?!1:(J.openMenu(e),!1)}),this.setValue=function(e,t){Z.val(e);var i=d(e);return t!==!0&&(Z.triggerHandler("update",[e,i,this]),O.triggerHandler("update",[e,i,this]),null!=q.select&&q.select.apply(J,[e,i])),O[G?"val":"text"](i)},G&&this.setValue(O[0].defaultValue,!0),this.getValue=function(){return[Z.val(),O[G?"val":"text"]()]},this.openMenu=function(t){function n(){x(W).hide(),h(W),y(j.parent(),W,!0),W.find(".mc_hover").removeClass("mc_hover"),W[q.openFx](q.openSpeed,function(){u(W)}),i.isIE6&&e.fn.bgIframe&&W.bgIframe()}return W.is(":visible")?t?J.closeMenu():!1:void(t?n():setTimeout(n,1))},this.closeMenu=function(){c(W),W.find("ul").filter(function(){return"visible"==this.style.visibility}).parent().each(function(){w.apply(this,[!0])}),W[q.closeFx](q.closeSpeed)},this.focus=function(){O.focus()},this.disable=function(e){N=!!e,j[N?"addClass":"removeClass"]("mcdropdownDisabled"),Y.attr("disabled",N)};var it=null;this.$mcDropdown=O,this.$input=Y,this.$hidden=Z,null!=q.init&&q.init.apply(J,[Y,Z,W])}}(jQuery);